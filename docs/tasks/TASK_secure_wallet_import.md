# Task: Secure Wallet Import via Web Form

## Context

Текущий `/wallet import <key>` требует отправки приватного ключа через Telegram-сообщение, что создаёт риск безопасности (данные проходят через серверы Telegram). Экспорт уже реализован безопасно через одноразовые ссылки — импорт должен использовать аналогичный механизм.

## Acceptance Criteria

- [ ] `/wallet import` (без аргументов) генерирует одноразовую ссылку на веб-форму
- [ ] Ссылка действует 10 минут (TTL)
- [ ] Веб-форма принимает seed-фразу (12/24 слова) ИЛИ приватный ключ (base58)
- [ ] Клиентская JS-валидация проверяет формат перед отправкой
- [ ] После успешного импорта: success-страница с сокращённым адресом (4...4)
- [ ] После успешного импорта: уведомление в Telegram с результатом
- [ ] Старый flow `/wallet import <key>` полностью удалён
- [ ] Токен одноразовый — после использования (успех или ошибка) становится невалидным
- [ ] Работает в обоих режимах: polling и webhook

## Scope

- Новый HTTP handler для GET/POST `/import/:token`
- Интерфейс MessageSender для отправки результата в Telegram
- Метод `SecretStore.peek()` для проверки токена без удаления
- HTML-форма с базовой стилизацией и JS-валидацией
- Изменение command handler `/wallet import`
- Регистрация handler в index.ts

## Out of Scope

- Сложная стилизация формы (достаточно функциональной)
- Поддержка других форматов ключей кроме seed/base58
- Rate limiting (отдельная задача)
- Аналитика/логирование использования
- Изменение логики ImportWalletUseCase

## Technical Notes

- Переиспользовать паттерн из `SecretPageHandler`
- `SecretStore` уже поддерживает payload — использовать для хранения telegramId
- Порядок инициализации в index.ts требует изменения: Bot должен создаваться до handlers
- DcaWalletFormatter нужно расширить методом `formatImportLink()`

## UI Specifications

### Веб-форма импорта

**Поля:**
- Textarea для ввода seed/key (placeholder: "Enter 12/24 word seed phrase or private key")
- Submit button "Import Wallet"

**Валидация (client-side):**
- Seed: ровно 12 или 24 слова, разделённых пробелами
- Private key: base58 строка 43-44 символа
- Показать inline error если формат неверный

**Success page:**
- Заголовок: "Wallet Imported Successfully"
- Текст: "Address: Xxxx...yyyy" (первые 4 + последние 4 символа)
- Инструкция: "You can close this page. Check Telegram for details."

**Error page:**
- Заголовок: "Import Failed"
- Текст ошибки от ImportWalletUseCase
- Инструкция: "Please try again later"
- Без кнопок/редиректов — просто информационная страница

### Telegram Messages

**После генерации ссылки:**
```
Для безопасного импорта кошелька перейдите по ссылке:
{url}

Ссылка действительна 10 минут.
```

**После успешного импорта (в Telegram):**
```
Кошелёк успешно импортирован!
Адрес: Xxxx...yyyy
```

**После ошибки импорта (в Telegram):**
```
Ошибка импорта: {error_message}
```

## Decisions Made

| Вопрос | Решение | Обоснование |
|--------|---------|-------------|
| TTL | 10 минут | Компромисс между UX (мобильный пользователь) и безопасностью |
| Старый flow | Полностью удалить | Оставлять дыру в безопасности нелогично |
| JS-валидация | Да | Улучшает UX, предотвращает лишние запросы |
| Success page | Сокращённый адрес | Полный адрес избыточен, есть в Telegram |

## Open Questions

Нет открытых вопросов.
